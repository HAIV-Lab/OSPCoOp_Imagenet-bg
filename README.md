# Overcoming Shortcut Problem in VLM for Robust Out-of-Distribution Detection

The code repository for "Overcoming Shortcut Problem in VLM for Robust Out-of-Distribution Detection" in PyTorch. 
    
## News

[03/2025]ðŸŽ‰  We have released the proposed [ImageNet-Bg](https://www.kaggle.com/datasets/xiangexiang/imagenet-bg-ospcoop-cvpr2025).

[02/2025]ðŸŽ‰  Our paper has been accepted by CVPR2025.

## The proposed ImageNet-Bg

To further test the robustness of the model against background interference, we propose an ImageNet background interference test set, ImageNet-Bg, based on the ImageNet validation set with 48,285 images. All images in this dataset are generated by removing ID-relevant regions from samples in the ImageNet validation set. We filter the images to obtain the ImageNet-Bg(S) test set, which contains purer background information with 24,863 images. 

<img src="Figs/ImageNet-bg.png" width="96%">

## Pseudo-OOD Generation

### Image Masking
Please follow these steps:
Step1: Please install [Grounded-Segment-Anything](https://github.com/IDEA-Research/Grounded-Segment-Anything).
Step2: Copy the ./GroundingSAM/masking.py file into your Grounded-Segment-Anything project directory.
Step3: Run the following command:
```
python ./GroundingSAM/masking.py --config GroundingDINO/groundingdino/config/GroundingDINO_SwinT_OGC.py   --grounded_checkpoint groundingdino_swint_ogc.pth   --sam_checkpoint sam_vit_h_4b8939.pth   --output_dir "output_dir"   --box_threshold 0.3   --text_threshold 0.25    --device "cuda"
```
Note: Set "output_dir" to your image directory, and place the images to be processed in the "./output_dir/raw" directory.
### Image Inpainting
